---
layout:     post
title:      "这就是搜索引擎第四章-索引压缩"
subtitle:   "这就是搜索引擎读书笔记"
date:       2016-05-17
author:     "秀川"
header-img: "img/post-bg-re-vs-ng2.jpg"
header-mask: 0.3
catalog:    true
tags:
    - 读书笔记
    - 《这就是搜索引擎》
    - 搜索
    - 索引压缩
---

# 索引压缩
索引压缩可以利用数据压缩算法，有效的将数据量减少，这样一方面可以减少索引占用的磁盘空间量，另一方面可以减少磁盘读写数据量，加快用户查询的响应速度。

倒排索引包含单词词典和倒排列表，所以针对索引的压缩算法，也分为针对词典的压缩与针对倒排列表的压缩。而对倒排列表的压缩又可以分为无损压缩与有损压缩

## 词典压缩
为了响应用户查询，词典信息往往会全部加载到内存中，以加快查找速度。如果数据量很大，内存未必能够放得下所有的词典数据，为了减小词典信息所占内存，一般可以考虑词典压缩技术来达到此目的。

![词典信息结构](词典信息结构.jpg "词典信息结构")

单词的长度往往不一致，所以我们可以对这个字段信息进行压缩。

我们把所有的单词连续的存储在某个内存中，原先存储单词内容的部分由指向这个存储区对应单词起始位置的指针代替。单词的结尾可以用词典中下一个单词的指针所指向位置来做判断。

进一步优化方案：

每个单词前面加上单词的长度信息，然后再存储到一块连续的内存中，让相邻的两项或者多项共用一个指针。假如是两个单词共用一个位置指针，这样就可以节省4个字节。

![进一步优化单词存储](进一步优化单词存储.jpg "进一步优化单词存储")

## 倒排列表压缩算法
单词对应的倒排列表记载3类信息：文档编号，词频信息和单词的位置信息。因为文档编号以及单词位置序列是一次递增的，所以通常的做法是存储其***差值***，而非原始数据，经过差值转换，文档编号和单词位置信息往往会被转换成小整数，而词频信息大部分是小整数。

### 评价索引压缩算法的指标
* 压缩率

数据压缩前的大小与压缩后的大小的比例关系，压缩率越高越节省空间

* 压缩速度

压缩一定量的数据所花费的时间，这个指标没有其他两个指标重要

* 解压速度

解压速度是3个指标中最重要的，其含义就是将压缩的数据再次恢复为原始数据所需时间

### 一元编码和二进制编码

一元编码和二进制编码是所有压缩算法的基本构成元素，不论压缩算法内部逻辑怎么样，最终都是以这两种双方是对数据进行表示。要么使用一元编码和二进制编码混合使用，用么是单独使用二进制编码。可以认为这两种编码格式是压缩算法的基础构件。

一元编码的数据表示方式：对于整数X来说，使用X-1个二进制数字1和一个数字0来表示这个整数。**一元编码只适合非常小的整数。
**

![一元编码]()

二进制编码是计算机内部的标准数据存储方式，即用二进制0和1表示实际的数据。不同比特宽度代表了不同数字的范围。

![二进制编码]()

### Elias Gamma算法和Elias Delta算法

### Golomb算法 和Rice 算法
