---
layout:     post
title:      "这就是搜索引擎第六章-检索模型与搜索排序"
subtitle:   "这就是搜索引擎读书笔记"
date:       2016-05-29
author:     "秀川"
header-img: "img/post-bg-re-vs-ng2.jpg"
header-mask: 0.3
catalog:    true
tags:
    - 读书笔记
    - 《这就是搜索引擎》
    - 搜索
    - 链接分析
---
# 链接分析

指向当前页面的链接称为***入链***

当前页面指向其他的页面的链接称为***出链***

***锚文字***是出链附近的一些描述信息，这种信息比较重要，因为锚文字是对网页的概括性描述

## 两个概念模型

* 随机游走模型

随机游走模型就是针对浏览网页的用户行为建立的抽象概念模型，PageRank算法在内的很多链接分析算法都是建立在随机游走模型基础上

用户打开浏览器的第一个页面，对网页中的某个链接指向的页面感兴趣，于是点击该链接，进入第二个页面，这种叫**直接跳转**。如果第一个页面中没有任何一个页面感兴趣，用户直接在浏览器中输入另一个网址，直接到达这个网页，这种称**远程跳转**。

`随机游走模型就是一个对直接跳转和远程跳转两种用户浏览行为进行抽象的概念模型。`

![随机游走模型](../../../../img/in-post/0512/随机游走模型.png "随机游走模型")

* 子集传播模型

子集传播模型是从诸多链接分析算法中抽象出来的概念模型，其基本思想是在做算法设计时，把互联网网页按照一定规则划分，分为多个子集合，给与子集合内网页初始权值，之后根据这个特殊子集合内网页和其他网页的链接关系，按照一定方式将权值传递到其他网页。

符合子集传播模型的链接分析算法有：`HITS算法`，`Hilltop算法`及其衍生算法。

子集传播模型是个高度抽象的算法框架，很多算法可以认为是属于此框架的具体事例，通常在以下几个方面各自存在不同；

1. 如何定义特殊子集合，即在确定子集合内的网页应该有哪些特殊性质，具体算法规则不同
2. 在确定了特殊子集合所有的性质后，如何对这个特殊子集合内网页给予一定的初始分值？不同算法打分方式各异
3. 从特殊子集合将其分值传播到其他网页时，采用何种传播方式？可传播距离有多远？不同算法在此阶段也大都有差异。

### 链接分析算法的关系

![链接分析算法关系图](../../../../img/in-post/0512/链接分析算法关系图.png "链接分析算法关系图")

在众多算法中，PageRank算法和HITS算法可以说是最重要的两个具有代表性的链接分析算法，后续很多链接分析算法都是在这两个算法基础上衍生出来的改进算法。

## PageRank算法
PageRank算法是Google创始人与1997年构建早起的搜索系统原型时提出的链接分析算法。自从google在商业上获得空前的成功以后，该算法也称为其他搜索引擎和学术界关注的计算模型。目前很多重要的链接分析算法都是在PageRank算法基础上衍生出来的。

### 从入链数量到PageRank

PageRank除了考虑入链数量的影响，还参考了网页质量因素，两者相结合获得了更好的网页重要性评价标准。

对于某个互联网网页A来说，该网页PageRank的计算基于以下两个基本假设：

* 数量假设：在web图模型中，如果一个页面节点接收到的其他网页指向的入链数量越多，那么这个页面越重要。
* 质量假设：指向页面A的入链质量不同，质量高的页面会通过链接向其他页面传递更多的权重。所以越是质量高的页面指向页面A，则页面A越重要。

通过以上两个假设，PageRank算法刚开始赋予每个网页相同的重要性得分，通过迭代递归计算来更新每个页面节点的PageRank得分，知道得分稳定位置。

> PageRank计算得出的结果是网页重要性评价，这和用户输入的查询是没有任何关系的，即算法是主体无关的。假设有一个搜索引擎，其相似度计算函数不考虑内容相似因素，完全采用PageRank来进行排序，那么这个搜索引擎对于任意不同的查询请求，返回的结果都是相同的，即返回PageRank值最高的页面。

### PageRank 计算

在初始阶段，每个网页设置相同的PageRank值，通过若干轮的计算，会得到每个页面所获得的最终PageRank值。随着每一轮的计算进行，网页当前的PageRank值会不断得到更新。

在一轮更新页面PageRank得分的计算中，每个页面将其当前的PageRank值平均分配到本页面包含的出链上，这样每个链接即获得了相应的权值。而每个页面将所有指向本页面的入链所传入的权值求和，即得到新的PageRank得分。当每个页面都获得了更新后的PageRank值，就完成了一轮PageRank计算。

![PageRank计算实例](../../../../img/in-post/0512/PageRank计算实例.png "PageRank计算实例")

上图中页面1，有4个入链，分别来自于页面2，3，5，6。每个链接传到的权值也如图所标，那么页面1的新的PageRank值为4个入链传入的权值之和，即：PR(1) = 0.166 + 0.071 + 0.045 + 0.023 = 0.305
即得分从上一轮的0.304更新到0.305。

其他页面节点也依次如此计算，以获得新的PageRank分值，当所有页面节点的分值得到更新就完成了一轮PageRank计算。如果在新的一轮PageRank计算之后，发现总体而言，页面节点的PageRank值基本稳定，不再发生较大变化，即可结束PageRank的计算，以此时得到的得分，做为最后排序时可以利用的PageRank得分。

### 链接陷阱和远程跳转
![链接陷阱](../../../../img/in-post/0512/链接陷阱.png "链接陷阱")

上图所示的3个网页，相互有链接指向，形成一个环形结构，在计算PageRank的时候，该结构将导致系统只会吸收传入的分值，而不能将获得的分值传播出去，随着PageRank一轮轮德连续运算，链接陷阱内的页面PageRank得分越来越高，这与PageRank的设计初衷相违背。

***远程跳转***是解决链接陷阱的通用方式，所以的远程跳转，即在网页向外传递分值的时候，不限于向出链所指网页传递，也可以以一定的概率向任意其他网页跳转。对于链接陷阱内的网页来说，增加了远程跳转措施后，就像为每个页面增加了指向互联网任意其他页面的虚拟边，权值可以通过这种虚拟边向外传递，以此来避免链接陷阱导致的问题。

## HITS算法（Hypertext Induced Topic Selection）

HITS算法也是链接分析中非常基础且重要的算法。

### Hub页面与Authority页面
Hub页面与Authority页面是HITS算法最基本的两个定义。

所谓Authority页面，指的是与某个领域或者某个话题相关的高质量网页。比如搜索引擎领域，Google和百度首页即该领域的高质量网页；比如视频领域，优酷和土豆首页即该领域的高质量网页。

所谓Hub页面，指的是包含了很多指向高质量Authority页面链接的网页，比如hao123首页可以认为是一个典型的高质量Hub网页。

HITS算法的目的是通过一定的技术手段，在海量网页中找到与用户查询主题相关的高质量Authority页面和Hub页面，尤其是Authority页面，因为这些页面代表了能够满足用户查询的高质量内容，搜索引擎以此作为搜索结果返回给用户。

### 相互增强关系
HITS算法隐含并利用了两个基本假设：

* 基本假设1：一个好的Authority页面*会被很多好的*Hub页面指向。

> 被越多的Hub页面指向越好，指向该页面的Hub页面质量越高则页面越好

* 基本假设2：一个好的Hub页面*会指向很多好的*Authority页面。

> 指向的Authority页面数量越多越好，指向的Authority页面质量越高，则该Hub页面越好

从以上两个基本假设可以推导出Hub页面与Authority页面之间的相互增强关系，即某个网页的Hub质量越高，则其链接指向的页面的Authority质量越好，反过来也是如此，一个网页的Authority质量越高，则那些有链接指向本网页的页面Hub质量越高。通过这种相互增强关系不断迭代计算，即可找出哪些页面是高质量的Hub页面，哪些是高质量的Authority页面。

### HITS 算法
HITS算法与pageRank算法一个显著的差异是：HITS算法与用户输入的查询请求密切相关，而PageRank算法是与查询无关的全局算法。HITS算法后续计算步骤都是在接收到用户查询后展开的，即是与查询相关的链接分析算法。

HITS算法接收到用户查询之后，将查询提交给某个现有的搜索引擎，并在返回的搜索结果中提取排名靠前的网页，得到一组与用户查询高度相关的初始网页集合，这个集合被称作根集（Root Set）。

在根集的基础上，HITS算法对网页集合进行扩充。凡是与根集内网页有直接连接指向关系的网页都被扩充进来，无论是有链接指向根集内页面还是根集内页面有链接指向的页面。HITS算法在扩展网页集合内寻找好的Hub页面和好的Authority页面。

![根集与扩展网页集合](../../../../img/in-post/0512/根集与扩展网页集合.png "根集与扩展网页集合")

对于每个页面都设立两个权值，分别来记载这个页面是好Hub页面或者Authority页面的可能性。在初始情况下，每个页面的这两个权值都是相同的，可以设置为1。之后，利用之前提到的两个基本假设，以及相互增强关系等原则进行多轮迭代计算，每轮迭代计算更新每个页面的两个权值，直到权值稳定不再发生明显的变化为止。

![Hub和Authority权值计算](../../../../img/in-post/0512/Hub和Authority权值计算.png "Hub和Authority权值计算")

某个网页的Hub权值和Authority权值的更新方式，假设A(i)代表网页i的Authority权值，以H(i)代表网页的Hub权值。在上面的例子中，扩展网页集合有3个网页有链接指向页面1，同时页面1有3个链接指向其他的页面。那么网页1在此轮迭代中Authority权值即为所有1页面的入链的Hub权值之和；类似的，网页1的Hub权值即为所有出链页面的Authority权值之和。

当每个页面的权值都获得了更新，则完成了一轮迭代计算，此时HITS算法会评估上一轮迭代计算中的权值和本轮迭代之后权值的差异，如果发现总体来说权值没有明显的变化，说明系统已进入稳定状态，则可以结束计算。如果发现两轮计算总体权值差异较大，则继续进入下一轮迭代计算，直到整个系统权值稳定为止。

最后将页面根据Authority权值得分由高到低排序，取权值最高的若干页面做为响应用户查询的搜索结果输出。

### HITS算法存在的问题

* 计算效率较低

因为HITS算法是查询相关算法，所以必须在接收到用户查询后实时进行计算，而HITS算法本身需要进行很多轮迭代计算才能获得最终结果，这导致其计算效率较低，实际应用中需要慎重考虑。

* 主题飘逸问题
如果在扩展网页集合里包含部分与查询主体无关的页面，而这些页面有较多的相互链接指向，那么使用HITS算法很可能会给予这些无关网页很高的排名，导致搜索结果发生主题漂移，这种现象被称为紧密链接社区现象。

* 易被作弊者操纵结果

HITS算法从机制上很容易被作弊者操纵，比如作弊者可以建立一个网页，页面内容增加很多指向高质量网页或者注明网站的网址，这就是一个很好的Hub页面，之后作弊者再将这个网页指向作弊网页，于是可以提升作弊网页的Authority得分。

* 结构不稳定

所谓结构不稳定，就是说在原有的扩展网页集合内，如果添加删除个别网页或者改变少数链接关系，则HITS算法的排名结果就会有非常大的改变。

### HITS算法与PageRank算法比较

1. HITS算法是与用户输入的查询请求密切相关的，而PageRank算法与查询请求无关。所以HITS算法可以单独作为相似性计算评价标准，而PageRank必须结合内容相似性计算才可以用来对网页相关性进行评价。
2. HITS算法因为与用户查询密切相关，所以必须在接收到用户查询后进行实时计算，计算效率较低；而PageRank则可以在爬虫抓取完成后离线计算，在线直接使用计算结果，计算效率较高。
3. HITS算法的计算对象数量较少，只需要计算扩展集合内网页之间的链接关系；而PageRank是全局性算法，对所有互联网页面节点进行处理。
4. 从两者的计算效率和处理对象集合大小来比较，PageRank更适合部署在服务器端，而HITS算法更适合部署在客户端。
5. HITS算法在计算时，对于每个页面需要计算两个分值，而PageRank算法只需要算一个分值即可；搜搜索引擎领域，更重视HITS算法计算出的Authority权值。而在很多应用HITS算法的其他领域，Hub分值也很重要
6. 从链接反作弊角度来说，PageRank从机制上优于HITS算法，而HITS算法更易遭受链接作弊影响。
7. HITS算法结构不稳定，当对扩展网页集合内链接关系作出很小改变，则对最终排名有很大影响；而PageRank算法相对HITS而言表现稳定，其根本原因在于PageRank计算时的远程跳转。

## SALSA算法
SALSA算法融合了PageRank和HITS算法的基本思想，是目前效果最好的链接分析算法之一。

从整体流程来说，SALSA划分为两个大的阶段：首先是确定计算对象集合阶段，这与HITS算法基本相同；第二阶段是链接关系传播过程，在这一阶段采纳了随机游走模型。

### 确定计算对象集合
PageRank的计算对象是所有网页，而SALSA算法与此不同，在本阶段，其与HITS算法思路大致相同，也是先得到扩展网页集合，之后将网页关系转换为方向二分图形式。

* 扩展网页集合

这个阶段和HITS算法的方式一模一样的

* 转换为无向二分图

在获得了扩展网页集合之后，SALSA根据集合内的网页链接关系，将网页集合转换为一个二分图。即将网页划分到两个子集合中，一个子集合是Hub集合，另一个子集合是Authority集合。划分网页节点属于哪个集合，则根据如下规则。

1. 如果一个网页包含出链，这些出链指向扩展网页集合内其他节点，则这个网页可以归为Hub集合。
2. 如果一个网页包含扩展网页集合内其他节点指向的入链，则可被归为Authority集合

由以上规则可以看出，如果网页同时包含入链和出链，则可以同时归入两个集合。同时Hub集合内网页的出链组成了二分图的边，根据以上法则，将扩展网页集合转换为二分图。
![扩展网页集合实例](../../../../img/in-post/0512/扩展网页集合实例.png "扩展网页集合实例")
将上图的网页集合关系转换成下图的二分图的形式，*此处SALSE算法将扩展网页集合转换为无向二分图，而HITS算法任然是有向二分图*，其他步骤SALSA算法和HITS算法完全相同。
![二分图](../../../../img/in-post/0512/二分图.png "二分图")

### 链接关系传播
在链接关系传播阶段，SALSA算法放弃了HITS算法的Hub节点和Authority节点相互增强的假设，转而采纳PageRank的随机游走模型。

* 链接关系传播概念模型

在上面的二分图中，假如有一个浏览者从Hub集合的节点1出发，如果节点包含多条边，则以相等概率随机选择一条边，从Hub子集合跳转到Authority结合内节点，图中所示为由节点1转移到节点3之后从Authority子集合再次跳回到Hub子集合，即由节点3跳到节点6，如此不断在两个子集之间转移，形成了SALSA自身的链接关系传播模式。

这种传播模式与PageRank相同，与HITs不同，因为从某个节点跳到另一个节点的时候，如果包含多个可供选择的链接，则以等概率随机选择一条路径，即在权值传播过程中，权值是被所有链接平均分配的，而HITS算法是广播模式，即将本身的权值完全传播给有链接指向的节点，并不根据链接多少进行分配。

* Authority节点关系图

![Authority节点关系图](../../../../img/in-post/0512/Authority节点关系图.png "Authority节点关系图")

节点6为什么指向自身的概率是0.83？首先从节点6出发到Hub集合有3条路径，概分别为1/3，其中3和10节点到Authority集合中的节点6只有一种可能，所以Authority集合中的6通过Hub集合中的3或者10，回到自身几点的概率分别是1/3,然后再看Hub集合中的1节点，这个节点有两条边，所以从Hub集合中的节点1到Authority集合中的节点6的概率是0.5，所以Authority集合中的节点6出发回到自身的概率为1/3+1/3+0.5=0.83。

* 节点关系图中边的建立

之所以在Authority节点图中，节点3有边指向节点5，是因为在二分图中，由节点3通过Hub子集合的节点6中转，可以通达节点5，所以两者之间有边建立。

在二分图中，对于Authority集合内的某个节点来说，一定可以通过Hub子集合的节点中转后再次返回本身，所以一定包含一条指向自身的有向边。节点1因为只有中转节点2使得其返回Authority子集合中的自节点，所以只有指向自身的一条边，和其他节点没有边联系，所以例子中的Authority节点关系图有两个联通子图构成，一个只有节点1，另外一个联通子图由剩余几个节点构成。

* 节点之间的概率转移

如何计算Authority集合中节点转移的概率在上面已经有描述了，不再赘述。

建立好Authority节点关系后，即可在图上利用随机游走模型来计算每个节点的Authority权值。在实际计算过程中，SALSA将搜索结果排序问题进一步转换为求AUthority节点矩阵的主秩问题，矩阵的主秩即为每个节点的相应Authority得分，按照Authority得分由高到低排列，即可得到最终的搜索排序结果。

### Authority权值计算
经过数学推导，可以得出SALSA与求矩阵主秩等价的***Authority权值计算公式:***权值=(|A<sub>j</sub>|/|A|)x(|B(i)|/|E<sub>j</sub>|)；

* \|A<sub>j</sub>\|：节点所在连通图包含的节点数
* \|A\|：Authority子集中节点总数
* \|B(i)\|：节点的入链个数
* \|E<sub>j</sub>\|：节点所在连通图的入链总数

在以上4各因子中，除了入链个数之外，其他3各因子总是相同的，即只有入链个数起作用，所以SALSA算法可以退化为根据入链个数决定排序顺序的算法。SALSA算法不需要像HITS算法一样进行不断迭代计算，所以SALSA算法从效率上快于HITS算法，另外SALSA算法解决了HITS算法主题漂移问题，搜索质量也由于HITS算法。SALSA是目前最好的链接算法之一。

## 主体敏感PageRank算法
主体敏感PageRank是PageRank算法发改进版本，该算法已被Google使用在各种个性化搜索服务中。

### 主体敏感PageRank与PageRank的差异
PageRank算法基本遵循随机游走模型；主题敏感PageRank则对该模型进行改进。比如：浏览者浏览某个页面的时候，这个页面也是主题相关的，当用户看完当前页面，希望跳转时，更倾向于和当前页面主题类似的链接，即主题敏感PageRank是将用户兴趣，页面主题及链接所指向网页与当前网页主题的相似程度综合考虑而建立的模型。更符合真实用户的浏览过程。

PageRank是全局性的网页重要性衡量标准，每个网页会根据链接情况，被赋予一个唯一的PageRank分值；主题敏感PageRank算法引入16种主题类型，对于某个网页来说，对应某个主题类型都有相应的PageRank分值，即每个网页会被赋予16个主题相关PageRank分值。

主题敏感PageRank是查询相关的，可单独作为相似度计算公式使用。而接收到用户查询之后，主题敏感PageRank还需要利用分类器，计算该查询隶属于事先定义好的16个主题的隶属度，并在相似度计算时的排序公式中利用此信息。

### 主题敏感PageRank计算流程
主题敏感PageRank计算主要由两个步骤构成：
1. 离线的分类主题PageRank数值计算
主题敏感PageRank参考ODP网站（www.dmoz.org），定义了16类大的主题类别，包括体育、商业、科技等。ODP是人工整理的多层级网页分类导航站点，在顶级的16个大分类下面还有更细致的小粒度分类结构，在最底层目录下，人工搜集了符合该目录的精选高质量网页地址，以供互联网用户导航寻址。主题敏感PageRank采用了ODP最高级别的16个分类类别做为事先定义的主题类型。

![网页分类主题PageRank](../../../../img/in-post/0512/网页分类主题PageRank.png "网页分类主题PageRank")

在计算某个类别PageRank分值时，将所有网页划分为两个集合，一个是ODP对应分类主题下所包括的所有网页，即人工精选的高质量网页，称为S，剩余的网页在另一个集合内称为T，在计算PageRank时，S集合能够很好的表示分类主题，赋予较大的跳转概率值，通过这种设定，集合S内的网页根据链接关系像集合T中网页传递权值，因为直接链接指向的往往主题类似，这样就将该分类主题内容相似的网页赋予较高的PageRank值，而无关的网页则赋予较低权重的PageRank分值，以此方式表达对网页所包含主题的判断。

2. 在线利用计算好的主题PageRank分值，来评估网页和用户查询的相似度，以按照相似度排序给用户提供搜索结果

![在线相似度计算](../../../../img/in-post/0512/在线相似度计算.png "在线相似度计算")

主题敏感PageRank算法对查询的关键词进行分类，计算该关键词属于定义好的分类的概率（分类向量）分别是多少；然后从索引中找出所有的含有关键词的网页以及网页对应各个分类的PageRank向量，最后各个“分类向量”x“PageRank向量”的乘积总和就是该关键词与该网页的相似度。

### 利用主题敏感PageRank构造个性化搜索
计算相似度使用的只有用户当前输入的查询词，也可以利用用户过去的搜索记录等个性化信息。通过这种方式，可以将用户的个性化信息和当前的查询相融合来构造搜索系统，以此达到个性化搜索的目的，更精准额提供搜索服务。

## Hilltop算法
Hilltop算法是Torono大学研发的链接分析算法，在2004年被Google公司收购，而Google在之后的排序算法大改版中引入了Hilltop算法。

Hilltop算法融合了HITS和PageRank两个算法的基本思想。一方面，Hilltop是与用户查询请求相关的链接分析算法，吸收了HITS
算法根据用户查询获得高质量相关网页子集的思想，符合子集传播模型，是该模型的一个具体事例；同时，在权值传播过程中，Hilltop算法也采纳了PageRank的基本知道思想，即通过页面链接的数量和质量来确定搜索结果的排序权重。

### Hilltop算法的一些基本定义

从属网站定义满足条件：

* 条件1：主机ip地址的前3个子网段相同，比如：159.226.138.127和139.226.138，234
* 条件2：如果网站域名中的主域名相同，比如www.ibm.com和www.ibm.com.cn

非从属组织页面：如果两个页面不属于从属网站，则为非从属组织页面。

非从属组织页面代表的是页面的一种关系，单个页面是无所谓从属或者非从属组织页面的。
![从属组织页面与非从属组织页面](../../../../img/in-post/0512/从属组织页面与非从属组织页面.png "从属组织页面与非从属组织页面")

专家页面是Hilltop算法的另一个重要定义，即与某个主题相关的高质量页面，同时需要满足一下要求：这些页面的链接所指向的页面相互之间都是非从属组织页面，且这些被指向的页面大多数是与专家页面主题相近。

Hilltop算法将互联网页面划分为两类子集合，最重要的子集合是由专家页面构成的互联网页面子集，不在这个集合里面的互联网页面做为另一个集合，这个集合称为目标页面集合。

### Hilltop算法流程
![Hilltop算法流程](../../../../img/in-post/0512/Hilltop算法流程.png "Hilltop算法流程")

Hilltop算法首先从海量互联网网页中通过一定规则筛选出专家页面子集合，并单独为这个页面集合建立索引。

在接收到用户发出的某个查询请求时，首先根据用户查询的主题，从专家页面子集合中找出部分相关性最强的专家页面，并对每个专家页面计算相关性得分，然后根据目标页面和这些专家页面的链接关系来对目标页面进行排序。

基本思路遵循PageRank算法的链接数量假设和质量原则，将专家页面的得分通过链接关系传递给目标页面，并以此分数做为目标页面和用户查询相关性的排序得分。最后系统整合相关专家页面和得分较高的目标页面做为搜索结果返回给用户。

> 若Hilltop算法无法得到一个足够大的专家页面集合，则返回搜索结果为空。由此可以看出，Hilltop算法更注重搜索结果的精度和准确性，不太考虑搜索结果是否足够多或者对大多数用户查询是否都有相应的搜索结果，所以很多用户发出的查询的搜索结果为空。这意味着Hilltop算法可以与某个排序算法相结合，以提高排序准确性，但并不合适做为一个独立的网页排序算法来使用。

#### 专家页面搜索
Hilltop算法从1亿4千万网页中，通过计算筛选出250万规模的互联网页面做为专家页面集合。同时满足以下条件即可进入专家页面集合：

* 条件1：页面至少包含k个出链，这里数量k可认为指定。
* 条件2：k个出链指向的所有页面之间的关系都符合非从属组织页面要求。

还可以设定更苛刻的要求，比如要求这些专家页面所包含链接指向的页面中，大部分涉及的主题和专家页面的主题必须一致或者近似。

根据以上筛选出来的专家页面，索引系统只对网页中的关键片段进行索引。所谓***关键片段***，在Hilltop算法里包含了网页的3类信息：网页标题、H1标签被文字和URL锚文字。

网页的关键片段可以支配某个区域内包含的所有链接，支配关系代表了一种管辖范围，不同的关键片段链接的区域范围不同，页面标题可以支配页面内所有出现的链接，H1标签可以支配包围在<H1>和</H1>内的所有链接而URL锚文字只能支配本身唯一的链接。如图：
![关键片段链接支配关系](../../../../img/in-post/0512/关键片段链接支配关系.png "关键片段链接支配关系")

之所以定义这种支配关系，对于第2阶段将专家页面的分值传递到目标页面时候会起作用。

系统接收到用户查询Q，假设用户查询包含多个单词，Hilltop对专家页面进行打分主要参考以下3类信息：

* 关键片段包含多少查询词，包含的查询词越多，则分值越高
* 关键片段本身的类型信息，网页标题权值最高，H1标签次之，再次是链接锚文字。
* 用户查询和关键片段的失配率，即关键片段中不属于查询词的单词个数占关键片度总单词个数，这个值越小越好，越大则得分衰减越肚皮。

Hilltop综合考虑以上3类因素，拟合出打分函数来对专家页面是否与用户查询相关进行打分，选车相关性分值足够高的专家页面，再对目标页面进行相关性计算。

#### 目标页面排序
Hilltop算法包含一个基本假设，即认为一个目标页面如果是满足用户查询的高质量搜索结果，其充分必要条件是该目标页面有高质量专家页面链接指向。

Hilltop在本阶段是基于专家页面和目标页面之间的链接关系来进行的，在此基础上，将专家页面的得分传递给有链接关系的目标页面。传递分值之前，首先需要对链接关系进行整理，能够获得专家页面分值的目标页面需要满足以下两点要求：

* 条件1：至少需要两个专家页面有链接指向目标页面，而且这两个专家页面不能是从属组织页面，即不能来自同一网站或者相关网站。
* 专家页面和所指向的目标页面也需要符合一定要求，即这两个页面也不能是从属组织页面。

能够获得传递分值的目标页面一定有多个专家页面链接指向，所以目标页面所获得的总传播分值是每个有链接指向的专家页面所传递分值之和。而计算其中某个专家页面传递给目标页面权值的时候是这么计算的：

a. 找到专家页面中那些能够支配目标页面的关键片段集合S
b. 统计S中包含用户查询词的关键片段个数T，T越大传递的权值越大
c. 专家页面传递给目标页面的分值为：E x T，E为专家页面本身在第一阶段计算得到的相关得分，T为b步骤计算的分值

Hilltop算法存在与HITS算法类似的计算效率问题，因为根据查询主题从专家页面集合中选取主题相关的页面自己也是在线运行的，这与前面提到的HITS算法一样会影响查询相应时间。随着专家页面集合的增大，算法可扩展性存在不足之处。

## 其他改进算法
除了以上5中重要的链接分析算法，学术界提出了很多改进的方法。

### 智能游走模型
智能游走模型考虑到了网页内容和用户输入查询词的相关性，所以是查询相关的链接分析算法。计算速度较慢是其重要缺陷。

### 偏置游走模型
偏置游走模型考虑的是链接指向的网页内容和当前浏览网页内容之间的相似性，即认为如果链接指向网页内容和当前浏览网页内容越相似，则用户点击这个链接的可能性就越大。由于没有考虑用户查询，可以离线进行计算，速度优于只能游走模型。

### PHITS算法
PHITS算法是对HITS算法的直接改进。HITS算法通过链接进行权值传递是，会将Hub或者Authority节点的权值全部传递给所有相连的链接，而PHITS算法认为不同链接其传递权值的能力应该是不同的，PHITS需要计算两个页面S和T之间链接的链接强度。PHITS算法考虑的其实是S和T页面之间的内容相似性，内容越相似其链接强度越强，传递权值的能力越强。PHITS算法和直接计算页面内容相似性的区别，仅仅是加入了一个隐藏主题层，通过网页和隐藏层的关系来计算相似性。

### BFS算法
BFS算法是对SALSA算法的改进。SALSA算法在计算网页的Authority分值时，仅仅考虑了通过Hub节点能够直接建立联系的网页之间的关系，而HITS算法考虑的是连接图的整个结构，任意两个网页S和T，如果网页S能够通过中间节点连接到T，则网页S就对网页T有影响，而影响的大小取决于从S到T的不同路径走法的个数，与S和T的距离远近没有关系。

BFS则是对两者的一个折中考虑，解除了SALSA算法只允许直接相邻网页才能有影响的限制，只要网页S可以通达T，即可对网页T施加影响，但是又对HITS的网页影响方式醉了限制，如果网页S距离T距离越远，那么网页S的影响就随着距离的增大而呈指数衰减，即距离越远，影响越小。
